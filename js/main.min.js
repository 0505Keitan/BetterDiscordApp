function Core(){}function EmoteModule(){}function PublicServers(){}function QuickEmoteMenu(){}function SettingsPanel(){utils.injectJs("https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/codemirror.min.js"),utils.injectJs("https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/mode/css/css.min.js"),utils.injectJs("https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.4.2/Sortable.min.js")}function Utils(){}function VoiceMode(){}function PluginModule(){}function ThemeModule(){}function BdWSocket(){bdws=this}function BdApi(){}var settingsPanel,emoteModule,utils,quickEmoteMenu,opublicServers,voiceMode,pluginModule,themeModule,jsVersion=1.57,supportedVersion="0.2.3",mainObserver,twitchEmoteUrlStart="https://static-cdn.jtvnw.net/emoticons/v1/",twitchEmoteUrlEnd="/1.0",ffzEmoteUrlStart="https://cdn.frankerfacez.com/emoticon/",ffzEmoteUrlEnd="/1",bttvEmoteUrlStart="https://cdn.betterttv.net/emote/",bttvEmoteUrlEnd="/1x",mainCore,settings={"Save logs locally":{id:"bda-gs-0",info:"Saves chat logs locally",implemented:!1},"Public Servers":{id:"bda-gs-1",info:"Display public servers button",implemented:!0},"Minimal Mode":{id:"bda-gs-2",info:"Hide elements and reduce the size of elements.",implemented:!0},"Voice Mode":{id:"bda-gs-4",info:"Only show voice chat",implemented:!0},"Hide Channels":{id:"bda-gs-3",info:"Hide channels in minimal mode",implemented:!0},"Quick Emote Menu":{id:"bda-es-0",info:"Show quick emote menu for adding emotes",implemented:!0},"Show Emotes":{id:"bda-es-7",info:"Show any emotes",implemented:!0},"FrankerFaceZ Emotes":{id:"bda-es-1",info:"Show FrankerFaceZ Emotes",implemented:!0},"BetterTTV Emotes":{id:"bda-es-2",info:"Show BetterTTV Emotes",implemented:!0},"Emote Autocomplete":{id:"bda-es-3",info:"Autocomplete emote commands",implemented:!1},"Emote Auto Capitalization":{id:"bda-es-4",info:"Autocapitalize emote commands",implemented:!0},"Override Default Emotes":{id:"bda-es-5",info:"Override default emotes",implemented:!1},"Show Names":{id:"bda-es-6",info:"Show emote names on hover",implemented:!0}},links={"Jiiks.net":{text:"Jiiks.net",href:"http://jiiks.net",target:"_blank"},twitter:{text:"Twitter",href:"http://twitter.com/jiiksi",target:"_blank"},github:{text:"Github",href:"http://github.com/jiiks",target:"_blank"}},defaultCookie={version:jsVersion,"bda-gs-0":!1,"bda-gs-1":!0,"bda-gs-2":!1,"bda-gs-3":!1,"bda-gs-4":!1,"bda-es-0":!0,"bda-es-1":!0,"bda-es-2":!0,"bda-es-3":!1,"bda-es-4":!1,"bda-es-5":!0,"bda-es-6":!0,"bda-es-7":!0,"bda-jd":!0},bdchangelog={changes:{api:{title:"Api Functions!",text:"New api events!",img:""},dec:{title:"Decorations&Snow!",text:"Decorations and snow have been removed.",img:""}},fixes:{emotes:{title:"Sub emotes!",text:"Discord sub emotes are now replaced by BetterDiscord sub emotes and can be favorited!",img:""}},upcoming:{ignore:{title:"Ignore User!",text:"Ignore users you don't like!",img:""}}},settingsCookie={};Core.prototype.init=function(){function e(){if(console.log((new Date).getTime()+" Defer"),$(".guilds-wrapper .guilds").children().length>0){console.log((new Date).getTime()+" Defer Loaded");var i=$(".guilds li:first-child");i.after($("<li></li>",{id:"bd-pub-li",css:{height:"20px",display:1==settingsCookie["bda-gs-1"]?"":"none"}}).append($("<div/>",{"class":"guild-inner",css:{height:"20px","border-radius":"4px"}}).append($("<a/>").append($("<div/>",{css:{"line-height":"20px","font-size":"12px"},text:"public",id:"bd-pub-button"})))));var o=$("<button/>",{"class":"btn",id:"bd-show-channels",text:"R",css:{cursor:"pointer"},click:function(){settingsCookie["bda-gs-3"]=!1,$("body").removeClass("bd-minimal-chan"),t.saveSettings()}});if($(".guilds-wrapper").prepend(o),opublicServers=new PublicServers,pluginModule=new PluginModule,pluginModule.loadPlugins(),"undefined"!=typeof themesupport2&&(themeModule=new ThemeModule,themeModule.loadThemes()),settingsPanel=new SettingsPanel,settingsPanel.init(),quickEmoteMenu.init(!1),$("#tc-settings-button").on("click",function(){settingsPanel.show()}),$("#bd-pub-button").on("click",function(){opublicServers.show()}),opublicServers.init(),emoteModule.autoCapitalize(),settingsCookie.version<jsVersion){var n=t.constructChangelog();$("body").append(n),settingsCookie.version=jsVersion,t.saveSettings()}$("head").append("<style>.CodeMirror{ min-width:100%; }</style>"),$("head").append('<style>div[id*="xLayer"] { font-size:3px !important; color:transparent !important; } </style>'),$("head").append('<script>var ns4=-1!=navigator.appName.indexOf("Netscape")&&!document.getElementById;window.JSFX||(JSFX=new Object),JSFX.layerNo=0,JSFX.createLayer=function(e,t){var n=null;if(document.layers){var o="xLayer"+JSFX.layerNo++;n=null==t?new Layer(2e3):new Layer(2e3,t.elem),n.document.open(),n.document.write(e),n.document.close(),n.moveTo(0,0),n.innerHTML=e}else if(document.all){t=null==t?document.body:t.elem;var o="xLayer"+JSFX.layerNo++,i=\'<DIV ID="\'+o+\'" STYLE="position:absolute;left:0;top:0;visibility:hidden">\'+e+"</DIV>";t.insertAdjacentHTML("BeforeEnd",i),n=document.all[o]}else if(document.getElementById){t=null==t?document.body:t.elem;var o="xLayer"+JSFX.layerNo++,i="position:absolute;left:0px;top:0px;visibility:hidden",r=document.createRange();n=document.createElement("DIV"),n.setAttribute("style",i),n.setAttribute("id",o),t.appendChild(n),r.setStartBefore(n),strFrag=r.createContextualFragment(e),n.appendChild(strFrag)}return n},JSFX.Layer=function(e,t){e&&("string"==typeof e?this.elem=JSFX.createLayer(e,t):this.elem=e,document.layers?(this.images=this.elem.document.images,this.parent=t,this.style=this.elem,null!=t&&(this.style.visibility="inherit")):(this.images=document.images,this.parent=t,this.style=this.elem.style),window[this.elem.id]=this)},JSFX.findLayer=function(e,t){if(document.layers){var n;null==t&&(t=document);var o=t.layers[e];if(null!=o)return o;for(n=0;n<t.layers.length;n++)if(o=JSFX.findLayer(e,t.layers[n].document),null!=o)return o;return"Undefined...."}return document.all?document.all[e]:document.getElementById?document.getElementById(e):"Undefined....."},JSFX.Layer.prototype.moveTo=function(e,t){this.style.left=e+"px",this.style.top=t+"px"},ns4&&(JSFX.Layer.prototype.moveTo=function(e,t){this.elem.moveTo(e,t)}),JSFX.Layer.prototype.show=function(){this.style.visibility="visible"},JSFX.Layer.prototype.hide=function(){this.style.visibility="hidden"},JSFX.Layer.prototype.isVisible=function(){return"visible"==this.style.visibility},ns4&&(JSFX.Layer.prototype.show=function(){this.style.visibility="show"},JSFX.Layer.prototype.hide=function(){this.style.visibility="hide"},JSFX.Layer.prototype.isVisible=function(){return"show"==this.style.visibility}),JSFX.Layer.prototype.setzIndex=function(e){this.style.zIndex=e},JSFX.Layer.prototype.getzIndex=function(){return this.style.zIndex},JSFX.Layer.prototype.setColor=function(e){this.style.color=e},ns4&&(JSFX.Layer.prototype.setColor=function(e){this.elem.document.write("<FONT COLOR=\'"+e+"\'>"+this.elem.innerHTML+"</FONT>"),this.elem.document.close()}),JSFX.Layer.prototype.setBgColor=function(e){this.style.backgroundColor=null==e?"transparent":e},ns4&&(JSFX.Layer.prototype.setBgColor=function(e){this.elem.bgColor=e}),JSFX.Layer.prototype.setBgImage=function(e){this.style.backgroundImage="url("+e+")"},ns4&&(JSFX.Layer.prototype.setBgImage=function(e){this.style.background.src=e}),JSFX.Layer.prototype.setContent=function(e){this.elem.innerHTML=e},ns4&&(JSFX.Layer.prototype.setContent=function(e){this.elem.document.write(e),this.elem.document.close(),this.elem.innerHTML=e}),JSFX.Layer.prototype.clip=function(e,t,n,o){this.style.clip="rect("+t+" "+n+" "+o+" "+e+")"},ns4&&(JSFX.Layer.prototype.clip=function(e,t,n,o){this.style.clip.top=t,this.style.clip.left=e,this.style.clip.bottom=o,this.style.clip.right=n}),JSFX.Layer.prototype.resizeTo=function(e,t){this.style.width=e+"px",this.style.height=t+"px"},ns4&&(JSFX.Layer.prototype.resizeTo=function(e,t){this.style.clip.width=e,this.style.clip.height=t}),JSFX.Layer.prototype.getX=function(){return parseInt(this.style.left)},JSFX.Layer.prototype.getY=function(){return parseInt(this.style.top)},ns4&&(JSFX.Layer.prototype.getX=function(){return this.style.left},JSFX.Layer.prototype.getY=function(){return this.style.top}),JSFX.Layer.prototype.getWidth=function(){return this.elem.offsetWidth},JSFX.Layer.prototype.getHeight=function(){return this.elem.offsetHeight},document.getElementById||(JSFX.Layer.prototype.getWidth=function(){return this.elem.scrollWidth}),ns4&&(JSFX.Layer.prototype.getWidth=function(){return this.style.clip.right},JSFX.Layer.prototype.getHeight=function(){return this.style.clip.bottom}),ns4?JSFX.Layer.prototype.setOpacity=function(e){return 0}:document.all?JSFX.Layer.prototype.setOpacity=function(e){""==this.style.filter&&(this.style.filter="alpha(opacity=100);"),this.elem.filters.alpha.opacity=e}:JSFX.Layer.prototype.setOpacity=function(e){this.style.MozOpacity=e+"%"},ns4?(JSFX.eventmasks={onabort:Event.ABORT,onblur:Event.BLUR,onchange:Event.CHANGE,onclick:Event.CLICK,ondblclick:Event.DBLCLICK,ondragdrop:Event.DRAGDROP,onerror:Event.ERROR,onfocus:Event.FOCUS,onkeydown:Event.KEYDOWN,onkeypress:Event.KEYPRESS,onkeyup:Event.KEYUP,onload:Event.LOAD,onmousedown:Event.MOUSEDOWN,onmousemove:Event.MOUSEMOVE,onmouseout:Event.MOUSEOUT,onmouseover:Event.MOUSEOVER,onmouseup:Event.MOUSEUP,onmove:Event.MOVE,onreset:Event.RESET,onresize:Event.RESIZE,onselect:Event.SELECT,onsubmit:Event.SUBMIT,onunload:Event.UNLOAD},JSFX.Layer.prototype.addEventHandler=function(e,t){this.elem.captureEvents(JSFX.eventmasks[e]);var n=this;this.elem[e]=function(e){return e.clientX=e.pageX,e.clientY=e.pageY,e.button=e.which,e.keyCode=e.which,e.altKey=0!=(e.modifiers&Event.ALT_MASK),e.ctrlKey=0!=(e.modifiers&Event.CONTROL_MASK),e.shiftKey=0!=(e.modifiers&Event.SHIFT_MASK),t(n,e)}},JSFX.Layer.prototype.removeEventHandler=function(e){this.elem.releaseEvents(JSFX.eventmasks[e]),delete this.elem[e]}):document.all?(JSFX.Layer.prototype.addEventHandler=function(e,t){var n=this;this.elem[e]=function(){var e=window.event;if(e.cancelBubble=!0,document.getElementById)e.layerX=e.offsetX,e.layerY=e.offsetY;else{ev=new Object;for(i in e)ev[i]=e[i];ev.layerX=e.offsetX,ev.layerY=e.offsetY,e=ev}return t(n,e)}},JSFX.Layer.prototype.removeEventHandler=function(e){this.elem[e]=null}):(JSFX.Layer.prototype.addEventHandler=function(e,t){var n=this;this.elem[e]=function(e){return e.cancelBubble=!0,t(n,e)}},JSFX.Layer.prototype.removeEventHandler=function(e){this.elem[e]=null}),JSFX.Layer.prototype.setTimeout=function(e,t){setTimeout("window."+this.elem.id+"."+e,t)};</script>'),$("head").append('<script>window.JSFX||(JSFX=new Object),JSFX.Browser||(JSFX.Browser=new Object),-1!=navigator.appName.indexOf("Netscape")?(JSFX.Browser.getCanvasWidth=function(){return innerWidth},JSFX.Browser.getCanvasHeight=function(){return innerHeight},JSFX.Browser.getWindowWidth=function(){return outerWidth},JSFX.Browser.getWindowHeight=function(){return outerHeight},JSFX.Browser.getScreenWidth=function(){return screen.width},JSFX.Browser.getScreenHeight=function(){return screen.height},JSFX.Browser.getMinX=function(){return pageXOffset},JSFX.Browser.getMinY=function(){return pageYOffset},JSFX.Browser.getMaxX=function(){return pageXOffset+innerWidth},JSFX.Browser.getMaxY=function(){return pageYOffset+innerHeight}):document.all&&(JSFX.Browser.getCanvasWidth=function(){return document.body.clientWidth},JSFX.Browser.getCanvasHeight=function(){return document.body.clientHeight},JSFX.Browser.getWindowWidth=function(){return document.body.clientWidth},JSFX.Browser.getWindowHeight=function(){return document.body.clientHeight},JSFX.Browser.getScreenWidth=function(){return screen.width},JSFX.Browser.getScreenHeight=function(){return screen.height},JSFX.Browser.getMinX=function(){return document.body.scrollLeft},JSFX.Browser.getMinY=function(){return document.body.scrollTop},JSFX.Browser.getMaxX=function(){return document.body.scrollLeft+document.body.clientWidth},JSFX.Browser.getMaxY=function(){return document.body.scrollTop+document.body.clientHeight});</script>'),$("head").append('<script>function dec2hex(t){return hexDigit[t>>4]+hexDigit[15&t]}function hex2dec(t){return parseInt(t,16)}var hexDigit=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");JSFX.FireworkSpark=function(t,r){this.superC=JSFX.Layer,this.superC("X"),this.dx=4*Math.random()-2,this.dy=4*Math.random()-2,this.ay=.09,this.x=t,this.y=r,this.type=0},JSFX.FireworkSpark.prototype=new JSFX.Layer,JSFX.FireworkSpark.prototype.fire0=function(){var t=6.294*Math.random(),r=2*Math.random();Math.random()>.6&&(r=2),this.dx=r*Math.sin(t),this.dy=r*Math.cos(t)-2},JSFX.FireworkSpark.prototype.fire1=function(){var t=6.294*Math.random(),r=2*Math.random();this.dx=r*Math.sin(t),this.dy=r*Math.cos(t)-2},JSFX.FireworkSpark.prototype.fire2=function(){var t=6.294*Math.random(),r=2;this.dx=r*Math.sin(t),this.dy=r*Math.cos(t)-2},JSFX.FireworkSpark.prototype.fire3=function(){var t=6.294*Math.random(),r=t-Math.random();this.dx=r*Math.sin(t),this.dy=r*Math.cos(t)-2},JSFX.FireworkSpark.prototype.fire4=function(){var t=6.294*Math.random(),r=Math.random()>.5?2:1;1==r?this.setFwColor=this.setFwColorR:this.setFwColor=this.setFwColorG,r-=Math.random()/4,this.dx=r*Math.sin(t),this.dy=r*Math.cos(t)-2},JSFX.FireworkSpark.prototype.fire=function(t,r,o,i){1==i?this.setFwColor=this.setFwColorR:2==i?this.setFwColor=this.setFwColorC:3==i?this.setFwColor=this.setFwColorG:4==i?this.setFwColor=this.setFwColorW:this.setFwColor=this.setFwColorY,1==o?this.fire1():2==o?this.fire2():3==o?this.fire3():4==o?this.fire4():this.fire0(),this.x=t,this.y=r,this.moveTo(t,r)},JSFX.FireworkSpark.prototype.setFwColor=function(t){this.setFwColorY(t)},JSFX.FireworkSpark.prototype.setFwColorR=function(t){var r=dec2hex(t),o="#"+r+"0000";this.setBgColor(o)},JSFX.FireworkSpark.prototype.setFwColorG=function(t){var r=dec2hex(t),o="#00"+r+"00";this.setBgColor(o)},JSFX.FireworkSpark.prototype.setFwColorC=function(t){var r=dec2hex(t),o="#00"+r+r;this.setBgColor(o)},JSFX.FireworkSpark.prototype.setFwColorY=function(t){var r=dec2hex(t),o="#"+r+r+"00";this.setBgColor(o)},JSFX.FireworkSpark.prototype.setFwColorW=function(t){var r=dec2hex(t),o="#"+r+r+r;this.setBgColor(o)},JSFX.FireworkSpark.prototype.animate=function(t){var r=30>t?255-4*t:Math.random()*(356-4*t);this.setFwColor(r),this.dy+=this.ay,this.x+=this.dx,this.y+=this.dy,this.moveTo(this.x,this.y)},JSFX.FireObj=function(t,r,o){for(this.id="JSFX_FireObj_"+JSFX.FireObj.count++,this.sparks=new Array,i=0;i<t;i++)this.sparks[i]=new JSFX.FireworkSpark(r,o),this.sparks[i].clip(0,0,3,3),this.sparks[i].setBgColor("yellow"),this.sparks[i].show();this.step=0,window[this.id]=this,this.animate()},JSFX.FireObj.count=0,JSFX.FireObj.prototype.explode=function(){var t=50+Math.random()*(JSFX.Browser.getMaxX()-200),r=50+Math.random()*(JSFX.Browser.getMaxY()-200),o=Math.floor(5*Math.random()),e=Math.floor(5*Math.random());for(i=0;i<this.sparks.length;i++)this.sparks[i].fire(t,r,o,e)},JSFX.FireObj.prototype.animate=function(){for(setTimeout("window."+this.id+".animate()",40),this.step>50&&(this.step=0),0==this.step&&this.explode(),this.step++,i=0;i<this.sparks.length;i++)this.sparks[i].animate(this.step)},JSFX.Fire=function(t,r,o){return new JSFX.FireObj(t,r,o)},-1==navigator.appName.indexOf("Netscape")||document.getElementById||(JSFX.ns_resize||(JSFX.ow=outerWidth,JSFX.oh=outerHeight,JSFX.ns_resize=function(){(outerWidth!=JSFX.ow||outerHeight!=JSFX.oh)&&location.reload()}),window.onresize=JSFX.ns_resize);</script>')}else setTimeout(e,100)}var t=this;if(version<supportedVersion)return void this.alert("Not Supported","BetterDiscord v"+version+"(your version) is not supported by the latest js("+jsVersion+").<br><br> Please download the latest version from <a href='https://betterdiscord.net' target='_blank'>BetterDiscord.net</a>");utils=new Utils;var i=new BdWSocket;i.start(),utils.getHash(),emoteModule=new EmoteModule,quickEmoteMenu=new QuickEmoteMenu,voiceMode=new VoiceMode,emoteModule.init(),this.initSettings(),this.initObserver(),$(document).ready(function(){setTimeout(e,1e3)})},Core.prototype.initSettings=function(){if(void 0==$.cookie("better-discord"))settingsCookie=defaultCookie,this.saveSettings();else{this.loadSettings();for(var e in defaultCookie)void 0==settingsCookie[e]&&(settingsCookie[e]=defaultCookie[e],this.saveSettings())}},Core.prototype.saveSettings=function(){$.cookie("better-discord",JSON.stringify(settingsCookie),{expires:365,path:"/"})},Core.prototype.loadSettings=function(){settingsCookie=JSON.parse($.cookie("better-discord"))},Core.prototype.initObserver=function(){mainObserver=new MutationObserver(function(e){e.forEach(function(e){null!=e.target.getAttribute("class")&&(-1!=e.target.getAttribute("class").indexOf("titlebar")&&(quickEmoteMenu.obsCallback(),voiceMode.obsCallback(),"undefined"!=typeof pluginModule&&pluginModule.channelSwitch()),-1!=e.target.getAttribute("class").indexOf("scroller messages")&&"undefined"!=typeof pluginModule&&pluginModule.newMessage()),emoteModule.obsCallback(e)})}),mainObserver.observe(document,{childList:!0,subtree:!0})},Core.prototype.constructChangelog=function(){var e='<div id="bd-wn-modal" class="modal" style="opacity:1;">  <div class="modal-inner">       <div id="bdcl" class="change-log">            <div class="header">               <strong>What\'s new in BetterDiscord JS v1.53&'+jsVersion+'</strong>               <button class="close" onclick=\'$("#bd-wn-modal").remove();\'></button>           </div><!--header-->           <div class="scroller-wrap">               <div class="scroller">';if(null!=bdchangelog.changes){e+='<h1 class="changelog-added">   <span>New Stuff</span></h1><ul>';for(var t in bdchangelog.changes)t=bdchangelog.changes[t],e+="<li>   <strong>"+t.title+"</strong>   <div>"+t.text+"</div></li>";e+="</ul>"}if(null!=bdchangelog.fixes){e+='<h1 class="changelog-fixed">   <span>Fixed</span></h1><ul>';for(var i in bdchangelog.fixes)i=bdchangelog.fixes[i],e+="<li>   <strong>"+i.title+"</strong>   <div>"+i.text+"</div></li>";e+="</ul>"}if(null!=bdchangelog.upcoming){e+='<h1 class="changelog-in-progress">   <span>Coming Soon</span></h1><ul>';for(var o in bdchangelog.upcoming)o=bdchangelog.upcoming[o],e+="<li>   <strong>"+o.title+"</strong>   <div>"+o.text+"</div></li>";e+="</ul>"}return e+='               </div><!--scoller-->           </div><!--scroller-wrap-->           <div class="footer">           </div><!--footer-->       </div><!--change-log-->   </div><!--modal-inner--></div><!--modal-->'},Core.prototype.alert=function(e,t){$("body").append('<div class="bd-alert">   <div class="bd-alert-header">       <span>'+e+'</span>       <div class="bd-alert-closebtn" onclick="$(this).parent().parent().remove();">×</div>   </div>   <div class="bd-alert-body">       <div class="scroller-wrap dark fade">           <div class="scroller">'+t+"</div>       </div>   </div></div>")};var emotesFfz={},emotesBTTV={},emotesTwitch={emotes:{emote:{image_id:0}}},subEmotesTwitch={};EmoteModule.prototype.init=function(){},EmoteModule.prototype.getBlacklist=function(){$.getJSON("https://cdn.rawgit.com/Jiiks/betterDiscordApp/"+_hash+"/emotefilter.json",function(e){bemotes=e.blacklist})},EmoteModule.prototype.obsCallback=function(e){var t=this;if(settingsCookie["bda-es-7"]){$(".emoji").each(function(){var e=$(this);-1!=e.attr("src").indexOf(".png")&&e.replaceWith("<span>"+e.attr("alt")+"</span>")});for(var i=0;i<e.addedNodes.length;++i){var o=e.addedNodes.item(i);if(o){var n=t.getNodes(o);for(var s in n)n.hasOwnProperty(s)&&t.injectEmote(n[s])}}}},EmoteModule.prototype.getNodes=function(e){for(var t,i=[],o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);t=o.nextNode();)i.push(t);return i};var bemotes=[],spoilered=[];EmoteModule.prototype.injectEmote=function(e){function t(){if($(i.parentElement).hasClass("markup")||$(i.parentElement).hasClass("message-content")){var e=i.innerHTML,t=e.split(/\s+/g);if(t&&(t.some(function(t){if("[!s]"==t.slice(0,4)){e=e.replace("[!s]","");var o=$(i).parent(),n=o.attr("data-reactid");if(spoilered.indexOf(n)>-1)return;return o.addClass("spoiler"),void o.on("click",function(){$(this).removeClass("spoiler"),spoilered.push($(this).attr("data-reactid"))})}if(!(t.length<4)){if("ClauZ"==t)return void(e=e.replace("ClauZ",'<img src="https://cdn.frankerfacez.com/emoticon/70852/1" style="width:25px; transform:translate(-29px, -14px);"></img>'));if(-1==$.inArray(t,bemotes)){if(emotesTwitch.emotes.hasOwnProperty(t)){var s=Math.round(t.length/4),r=t.substr(0,s)+"﷙"+t.substr(s,s)+"﷙"+t.substr(2*s,s)+"﷙"+t.substr(3*s),a=twitchEmoteUrlStart+emotesTwitch.emotes[t].image_id+twitchEmoteUrlEnd;return void(e=e.replace(t,'<div class="emotewrapper"><img class="emote" alt="'+r+'" src="'+a+'" /><input onclick=\'quickEmoteMenu.favorite("'+r+'", "'+a+'");\' class="fav" title="Favorite!" type="button"></div>'))}if("undefined"!=typeof emotesFfz&&settingsCookie["bda-es-1"]&&emotesFfz.hasOwnProperty(t)){var s=Math.round(t.length/4),r=t.substr(0,s)+"﷙"+t.substr(s,s)+"﷙"+t.substr(2*s,s)+"﷙"+t.substr(3*s),a=ffzEmoteUrlStart+emotesFfz[t]+ffzEmoteUrlEnd;return void(e=e.replace(t,'<div class="emotewrapper"><img class="emote" alt="'+r+'" src="'+a+'" /><input onclick=\'quickEmoteMenu.favorite("'+r+'", "'+a+'");\' class="fav" title="Favorite!" type="button"></div>'))}if("undefined"!=typeof emotesBTTV&&settingsCookie["bda-es-2"]&&emotesBTTV.hasOwnProperty(t)){var s=Math.round(t.length/4),r=t.substr(0,s)+"﷙"+t.substr(s,s)+"﷙"+t.substr(2*s,s)+"﷙"+t.substr(3*s),a=emotesBTTV[t];return void(e=e.replace(t,'<div class="emotewrapper"><img class="emote" alt="'+r+'" src="'+a+'" /><input onclick=\'quickEmoteMenu.favorite("'+r+'", "'+a+'");\' class="fav" title="Favorite!" type="button"></div>'))}if("undefined"!=typeof emotesBTTV2&&settingsCookie["bda-es-2"]&&emotesBTTV2.hasOwnProperty(t)){var s=Math.round(t.length/4),r=t.substr(0,s)+"﷙"+t.substr(s,s)+"﷙"+t.substr(2*s,s)+"﷙"+t.substr(3*s),a=bttvEmoteUrlStart+emotesBTTV2[t]+bttvEmoteUrlEnd;return void(e=e.replace(t,'<div class="emotewrapper"><img class="emote" alt="'+r+'" src="'+a+'" /><input onclick=\'quickEmoteMenu.favorite("'+r+'", "'+a+'");\' class="fav" title="Favorite!" type="button"></div>'))}if(subEmotesTwitch.hasOwnProperty(t)){var s=Math.round(t.length/4),r=t.substr(0,s)+"﷙"+t.substr(s,s)+"﷙"+t.substr(2*s,s)+"﷙"+t.substr(3*s),a=twitchEmoteUrlStart+subEmotesTwitch[t]+twitchEmoteUrlEnd;return void(e=e.replace(t,'<div class="emotewrapper"><img class="emote" alt="'+r+'" src="'+a+'" /><input onclick=\'quickEmoteMenu.favorite("'+r+'", "'+a+'");\' class="fav" title="Favorite!" type="button"></div>'))}}}}),null!=i.parentElement)){var o=i.parentElement.offsetHeight;i.innerHTML=e.replace(new RegExp("﷙","g"),"");var n=i.parentElement.offsetHeight,s=$(".scroller.messages").first();s.scrollTop(s.scrollTop()+(n-o))}}}if("undefined"!=typeof emotesTwitch&&e.parentElement){var i=e.parentElement;if("SPAN"==i.tagName){var o=!1;$(i.parentElement).hasClass("edited")&&(i=i.parentElement.parentElement.firstChild,o=!0),o?setTimeout(t,250):t()}}},EmoteModule.prototype.autoCapitalize=function(){var e=this;$("body").delegate($(".channel-textarea-inner textarea"),"keyup change paste",function(){if(settingsCookie["bda-es-4"]){var t=$(".channel-textarea-inner textarea").val();if(void 0!=t){var i=t.split(" ").pop();if(i.length>3){if("danSgame"==i)return;var o=e.capitalize(i.toLowerCase());null!==o&&void 0!==o&&$(".channel-textarea-inner textarea").val(t.replace(i,o))}}}})},EmoteModule.prototype.capitalize=function(e){var t=emotesTwitch.emotes;for(var i in t)if(t.hasOwnProperty(i)&&e==(i+"").toLowerCase())return i};var publicServers={servers:{server:{code:0,icon:null,title:"title",language:"EN",description:"description"}}};PublicServers.prototype.getPanel=function(){return this.container},PublicServers.prototype.init=function(){var e=this;this.container=$("<div/>",{id:"bd-ps-container",style:"display:none"});var t=$("<div/>",{id:"bd-ps-header"});$("<h2/>",{text:"Public Servers"}).appendTo(t),$("<span/>",{id:"bd-ps-close",style:"cursor:pointer;",text:"X"}).appendTo(t),t.appendTo(this.getPanel());var i=$("<div/>",{id:"bd-ps-body"});i.appendTo(this.getPanel());var o=$("<table/>",{border:"0"}),n=$("<thead/>");n.appendTo(o);var s=$("<tr/>",{}).append($("<th/>",{text:"Name"})).append($("<th/>",{text:"Code"})).append($("<th/>",{text:"Language"})).append($("<th/>",{text:"Description"})).append($("<th/>",{text:"Join"}));s.appendTo(n);var r=$("<tbody/>",{id:"bd-ps-tbody"});r.appendTo(o),o.appendTo(i),$("body").append(this.getPanel()),$("#bd-ps-close").on("click",function(){e.show()});var a=publicServers.servers;for(var l in a)if(a.hasOwnProperty(l)){var d=a[l],c=d.code,p=d.title,u=d.language,h=d.description;this.addServer(l,c,p,u,h)}},PublicServers.prototype.addServer=function(e,t,i,o,n){var s=this,r=$("#bd-ps-tbody"),a=$("<td/>").append($("<div/>",{"class":"bd-ps-description",text:n})),l=$("<tr/>");l.append($("<td/>",{text:i})),l.append($("<td/>",{css:{"-webkit-user-select":"initial","user-select":"initial"},text:t})),l.append($("<td/>",{text:o})),l.append(a),l.append($("<td/>").append($("<button/>",{text:"Join",css:{height:"30px",display:"block","margin-top":"10px","background-color":"#36393E",border:"1px solid #404040",outline:"1px solid #000",color:"#EDEDED"},click:function(){s.joinServer(t)}}))),r.append(l)},PublicServers.prototype.show=function(){this.getPanel().toggle();var e=$("#bd-pub-li");e.removeClass(),this.getPanel().is(":visible")&&e.addClass("active")},PublicServers.prototype.joinServer=function(e){$(".guilds-add").click(),$(".action.join .btn").click(),$(".create-guild-container input").val(e),$(".form.join-server .btn-primary").click()};var emoteBtn,emoteMenu;QuickEmoteMenu.prototype.init=function(e){emoteBtn=null,$(".channel-textarea").first().removeClass("emotemenu-enabled"),emoteMenu||this.initEmoteList();var t;emoteBtn=$("<div/>",{id:"twitchcord-button-container",style:"display:none"}).append($("<button/>",{id:"twitchcord-button",onclick:"return false;"})),$(".content.flex-spacer.flex-horizontal .flex-spacer.flex-vertical form").append(emoteBtn),emoteMenu.detach(),emoteBtn.append(emoteMenu),$("#twitchcord-button").on("click",function(){return t=!t,t?(emoteMenu.addClass("emotemenu-open"),$(this).addClass("twitchcord-button-open")):(emoteMenu.removeClass(),$(this).removeClass()),!1}),$(document).off("click.bdem").on("click.bdem",function(){t&&(t=!t,emoteMenu.removeClass(),$("#twitchcord-button").removeClass())}),$("#emote-menu").on("click",function(){return $("#rmenu").hide(),!1}),settingsCookie["bda-es-0"]&&($(".channel-textarea").first().addClass("emotemenu-enabled"),emoteBtn.show());var i=$(".emote-icon");i.off(),i.on("click",function(){var e=$(this).attr("title"),t=$(".channel-textarea-inner textarea");t.val(" "==t.val().slice(-1)?t.val()+e:t.val()+" "+e)});var o=localStorage.bdfavemotes;void 0!=o&&(favoriteEmotes=JSON.parse(atob(o)),this.updateFavorites())};var bdfw={};QuickEmoteMenu.prototype.obsCallback=function(){var e=$("#customcss").html();if("/channels/86004744966914048/86004744966914048"==window.location.pathname||e.indexOf("fireworks{}")>-1?e.indexOf("nofireworks{}")>-1?($("[id*=xLayer]").remove(),bdfw.id&&delete bdfw.id):bdfw=JSFX.Fire(100,40,40):($("[id*=xLayer]").remove(),bdfw.id&&delete bdfw.id),emoteBtn&&$(".content.flex-spacer.flex-horizontal .flex-spacer.flex-vertical form")){var t=$("#twitchcord-button-container");void 0==t.parent().prop("tagName")&&(quickEmoteMenu=new QuickEmoteMenu,quickEmoteMenu.init(!0))}};var favoriteEmotes={};QuickEmoteMenu.prototype.initEmoteList=function(){emoteMenu=$("<div/>",{id:"emote-menu"});var e=$("<div/>",{id:"emote-menu-header"}),t=$("<div/>",{id:"emote-menu-inner"}),i=$("<div/>",{id:"emote-menu-inner-fav",css:{display:"none"}}),o=$("<div/>",{"class":"emote-menu-tab emote-menu-tab-selected",id:"emgb",text:"Global",click:function(){$("#emfa").removeClass("emote-menu-tab-selected"),$("#emgb").addClass("emote-menu-tab-selected"),$("#emote-menu-inner-fav").hide(),$("#emote-menu-inner").show()}}),n=$("<div/>",{"class":"emote-menu-tab",id:"emfa",text:"Favorite",click:function(){$("#emgb").removeClass("emote-menu-tab-selected"),$("#emfa").addClass("emote-menu-tab-selected"),$("#emote-menu-inner").hide(),$("#emote-menu-inner-fav").show()}});e.append(o),e.append(n),emoteMenu.append(e);var s=$("<div/>",{"class":"scroller-wrap"}),r=$("<div/>",{"class":"scroller"});s.append(r),r.append(t),r.append(i),emoteMenu.append(s);for(var a in emotesTwitch.emotes)if(emotesTwitch.emotes.hasOwnProperty(a)){var l=emotesTwitch.emotes[a].image_id;t.append($("<div/>",{"class":"emote-container"}).append($("<img/>",{"class":"emote-icon",id:a,alt:"",src:"https://static-cdn.jtvnw.net/emoticons/v1/"+l+"/1.0",title:a})))}},QuickEmoteMenu.prototype.favorite=function(e,t){favoriteEmotes.hasOwnProperty(e)||(favoriteEmotes[e]=t),this.updateFavorites()},QuickEmoteMenu.prototype.updateFavorites=function(){$("#rmenu").length||($("body").append('<div id="rmenu"><ul><a href="#">Remove</a></ul></div>'),$(document).on("click",function(){$("#rmenu").hide()}));var e=this,t=$("#emote-menu-inner-fav");t.empty();for(var i in favoriteEmotes){var o=favoriteEmotes[i],n=$("<div/>",{"class":"emote-container"}),s=$("<img/>",{"class":"emote-icon",alt:"",src:o,title:i}).appendTo(n);t.append(n),s.off("click").on("click",function(e){var t=$(this).attr("title"),i=$(".channel-textarea-inner textarea");i.val(" "==i.val().slice(-1)?i.val()+t:i.val()+" "+t)}),s.off("contextmenu").on("contextmenu",function(t){var i=$(this).attr("title"),o=$("#rmenu");return o.find("a").off("click").on("click",function(){delete favoriteEmotes[i],e.updateFavorites()}),o.hide(),o.css({top:t.pageY,left:t.pageX}),o.show(),!1})}window.localStorage.bdfavemotes=btoa(JSON.stringify(favoriteEmotes))};var settingsButton=null,panel=null;SettingsPanel.prototype.init=function(){var e=this;e.construct();var t=$("body");settingsCookie["bda-es-0"]?$("#twitchcord-button-container").show():$("#twitchcord-button-container").hide(),settingsCookie["bda-gs-2"]?t.addClass("bd-minimal"):t.removeClass("bd-minimal"),settingsCookie["bda-gs-3"]?t.addClass("bd-minimal-chan"):t.removeClass("bd-minimal-chan"),settingsCookie["bda-gs-4"]&&voiceMode.enable(),settingsCookie["bda-jd"]&&(opublicServers.joinServer("0Tmfo5ZbORCRqbAd"),settingsCookie["bda-jd"]=!1,mainCore.saveSettings()),settingsCookie["bda-es-6"]?(emoteNamePopup=$("<div class='tipsy tipsy-se' style='display: block; top: 82px; left: 1630.5px; visibility: visible; opacity: 0.8;'><div class='tipsy-inner'></div></div>"),$(document).on("mouseover",".emote",function(){var e=$(this).offset(),t=$(this).attr("alt");$(emoteNamePopup).find(".tipsy-inner").text(t),$(emoteNamePopup).css("left",e.left-25),$(emoteNamePopup).css("top",e.top-32),$("div[data-reactid='.0.1.1']").append($(emoteNamePopup))}),$(document).on("mouseleave",".emote",function(){$(".tipsy").remove()})):$(document).off("mouseover",".emote")},SettingsPanel.prototype.applyCustomCss=function(e){0==$("#customcss").length&&$("head").append('<style id="customcss"></style>'),$("#customcss").html(e),localStorage.setItem("bdcustomcss",btoa(e))};var customCssInitialized=!1,lastTab="";SettingsPanel.prototype.changeTab=function(e){var t=this;lastTab=e;var i=$("#bd-control-groups");switch($(".bd-tab").removeClass("selected"),$(".bd-pane").hide(),$("#"+e).addClass("selected"),$("#"+e.replace("tab","pane")).show(),e){case"bd-settings-tab":break;case"bd-customcss-tab":if(!customCssInitialized){var o=CodeMirror.fromTextArea(document.getElementById("bd-custom-css-ta"),{lineNumbers:!0,mode:"css",indentUnit:4,theme:"neat"});o.on("change",function(e){var i=e.getValue();t.applyCustomCss(i)}),customCssInitialized=!0}break;case"bd-plugins-tab":break;case"bd-themes-tab":i.html("<span>Coming soon</span>")}},SettingsPanel.prototype.updateSetting=function(e){var t=$(e).children().find('input[type="checkbox"]'),i=!t.is(":checked"),o=t.attr("id");
t.prop("checked",i),settingsCookie[o]=i,settingsCookie["bda-es-0"]?$("#twitchcord-button-container").show():$("#twitchcord-button-container").hide(),settingsCookie["bda-gs-2"]?$("body").addClass("bd-minimal"):$("body").removeClass("bd-minimal"),settingsCookie["bda-gs-3"]?$("body").addClass("bd-minimal-chan"):$("body").removeClass("bd-minimal-chan"),settingsCookie["bda-gs-1"]?$("#bd-pub-li").show():$("#bd-pub-li").hide(),settingsCookie["bda-gs-4"]?voiceMode.enable():voiceMode.disable(),settingsCookie["bda-es-6"]?(emoteNamePopup=$("<div class='tipsy tipsy-se' style='display: block; top: 82px; left: 1630.5px; visibility: visible; opacity: 0.8;'><div class='tipsy-inner'></div></div>"),$(document).on("mouseover",".emote",function(){var e=$(this).offset(),t=$(this).attr("alt");$(emoteNamePopup).find(".tipsy-inner").text(t),$(emoteNamePopup).css("left",e.left-25),$(emoteNamePopup).css("top",e.top-32),$("div[data-reactid='.0.1.1']").append($(emoteNamePopup))}),$(document).on("mouseleave",".emote",function(){$(".tipsy").remove()})):$(document).off("mouseover",".emote"),mainCore.saveSettings()},SettingsPanel.prototype.construct=function(){function e(){$(".tab-bar-item").removeClass("selected"),settingsButton.addClass("selected"),$(".form .settings-right .settings-inner").first().hide(),panel.show(),""==lastTab?i.changeTab("bd-settings-tab"):i.changeTab(lastTab)}function t(){$(".btn.btn-settings").length<1?setTimeout(t,100):$(".btn.btn-settings").first().on("click",function(){function e(){if($(".modal-inner").first().is(":visible")){panel.hide();var t=$(".tab-bar.SIDE").first();$(".tab-bar.SIDE .tab-bar-item").click(function(){$(".form .settings-right .settings-inner").first().show(),$("#bd-settings-new").removeClass("selected"),panel.hide()}),t.append(settingsButton),$(".form .settings-right .settings-inner").last().after(panel),$("#bd-settings-new").removeClass("selected")}else setTimeout(e,100)}e()})}var i=this;panel=$("<div/>",{id:"bd-pane","class":"settings-inner",css:{display:"none"}});var o='<div class="scroller-wrap">   <div class="scroller settings-wrapper settings-panel">       <div class="tab-bar TOP">           <div class="tab-bar-item bd-tab" id="bd-settings-tab" onclick="settingsPanel.changeTab(\'bd-settings-tab\');">Settings</div>           <div class="tab-bar-item bd-tab" id="bd-customcss-tab" onclick="settingsPanel.changeTab(\'bd-customcss-tab\');">Custom CSS</div>           <div class="tab-bar-item bd-tab" id="bd-plugins-tab" onclick="settingsPanel.changeTab(\'bd-plugins-tab\');">Plugins</div>           <div class="tab-bar-item bd-tab" id="bd-themes-tab" onclick="settingsPanel.changeTab(\'bd-themes-tab\');">Themes</div>       </div>       <div class="bd-settings">               <div class="bd-pane control-group" id="bd-settings-pane" style="display:none;">                   <ul class="checkbox-group">';for(var n in settings){var s=settings[n],r=s.id;s.implemented&&(o+='<li><div class="checkbox" onclick="settingsPanel.updateSetting(this);" ><div class="checkbox-inner"><input type="checkbox" id="'+r+'" '+(settingsCookie[r]?"checked":"")+"><span></span></div><span>"+n+" - "+s.info+"</span></div></li>")}var a=atob(localStorage.getItem("bdcustomcss"));i.applyCustomCss(a),o+='</ul>               </div>               <div class="bd-pane control-group" id="bd-customcss-pane" style="display:none;">                   <textarea id="bd-custom-css-ta">'+a+'</textarea>               </div>               <div class="bd-pane control-group" id="bd-plugins-pane" style="display:none;">                   <table class="bd-g-table">                       <thead><tr><th>Name</th><th>Description</th><th>Author</th><th>Version</th><th></th><th></th></tr></thead><tbody>',$.each(bdplugins,function(){var e=this.plugin;o+="<tr>   <td>"+e.getName()+'</td>   <td width="99%"><textarea>'+e.getDescription()+"</textarea></td>   <td>"+e.getAuthor()+"</td>   <td>"+e.getVersion()+'</td>   <td><button class="bd-psb" onclick="pluginModule.showSettings(\''+e.getName()+'\'); return false;"></button></td>   <td>       <div class="checkbox" onclick="pluginModule.handlePlugin(this);">       <div class="checkbox-inner">               <input id="'+e.getName()+'" type="checkbox" '+(pluginCookie[e.getName()]?"checked":"")+">               <span></span>           </div>       </div>   </td></tr>"}),o+='</tbody></table>               </div>               <div class="bd-pane control-group" id="bd-themes-pane" style="display:none;">',"undefined"==typeof themesupport2?o+="                   Your version does not support themes. Download the latest version.":(o+='                   <table class="bd-g-table">                       <thead><tr><th>Name</th><th>Description</th><th>Author</th><th>Version</th><th></th></tr></thead><tbody>',$.each(bdthemes,function(){o+="<tr>   <td>"+this.name.replace(/_/g," ")+'</td>   <td width="99%"><textarea>'+this.description+"</textarea></td>   <td>"+this.author+"</td>   <td>"+this.version+'</td>   <td>       <div class="checkbox" onclick="themeModule.handleTheme(this);">           <div class="checkbox-inner">               <input id="ti'+this.name+'" type="checkbox" '+(themeCookie[this.name]?"checked":"")+">               <span></span>           </div>       </div>   </td></tr>"}),o+="</tbody></table>"),o+='               </div>       </div>   </div>   <div style="background:#2E3136; color:#ADADAD; height:30px; position:absolute; bottom:0; left:0; right:0;">       <span style="line-height:30px;margin-left:10px;">BetterDiscord v'+version+"(JSv"+jsVersion+') by Jiiks</span>       <span style="float:right;line-height:30px;margin-right:10px;"><a href="http://betterdiscord.net" target="_blank">BetterDiscord.net</a></span>   </div></div>',settingsButton=$("<div/>",{"class":"tab-bar-item",text:"BetterDiscord",id:"bd-settings-new",click:e}),panel.html(o),t()};var _hash;Utils.prototype.getTextArea=function(){return $(".channel-textarea-inner textarea")},Utils.prototype.jqDefer=function(e){window.jQuery?e():setTimeout(function(){this.jqDefer(e)},100)},Utils.prototype.getHash=function(){$.getJSON("https://api.github.com/repos/Jiiks/BetterDiscordApp/commits/master",function(e){_hash=e.sha,emoteModule.getBlacklist()})},Utils.prototype.loadHtml=function(e,t){var i=$("<div/>",{"class":"bd-container"}).appendTo("body");e="//cdn.rawgit.com/Jiiks/BetterDiscordApp/"+_hash+"/html/"+e+".html",i.load(e,t())},Utils.prototype.injectJs=function(e){$("<script/>",{type:"text/javascript",src:e}).appendTo($("body"))},Utils.prototype.injectCss=function(e){$("<link/>",{type:"text/css",rel:"stylesheet",href:e}).appendTo($("head"))},Utils.prototype.log=function(e){console.info("%c[BetterDiscord]%c "+e,"color:teal; font-weight:bold;","")},Utils.prototype.err=function(e){console.info("%c[BetterDiscord]%c "+e,"color:red; font-weight:bold;","")},VoiceMode.prototype.obsCallback=function(){var e=this;settingsCookie["bda-gs-4"]&&(e.disable(),setTimeout(function(){e.enable()},300))},VoiceMode.prototype.enable=function(){$(".scroller.guild-channels ul").first().css("display","none"),$(".scroller.guild-channels header").first().css("display","none"),$(".app.flex-vertical").first().css("overflow","hidden"),$(".chat.flex-vertical.flex-spacer").first().css("visibility","hidden").css("min-width","0px"),$(".flex-vertical.channels-wrap").first().css("flex-grow","100000"),$(".guild-header .btn.btn-hamburger").first().css("visibility","hidden")},VoiceMode.prototype.disable=function(){$(".scroller.guild-channels ul").first().css("display",""),$(".scroller.guild-channels header").first().css("display",""),$(".app.flex-vertical").first().css("overflow",""),$(".chat.flex-vertical.flex-spacer").first().css("visibility","").css("min-width",""),$(".flex-vertical.channels-wrap").first().css("flex-grow",""),$(".guild-header .btn.btn-hamburger").first().css("visibility","")};var pluginCookie={};PluginModule.prototype.loadPlugins=function(){this.loadPluginData(),$.each(bdplugins,function(){var e=this.plugin;e.load();var t=e.getName(),i=!1;pluginCookie.hasOwnProperty(t)?i=pluginCookie[t]:pluginCookie[t]=!1,i&&e.start()})},PluginModule.prototype.handlePlugin=function(e){var t=$(e).children().find('input[type="checkbox"]'),i=!t.is(":checked"),o=t.attr("id");t.prop("checked",i),i?(bdplugins[o].plugin.start(),pluginCookie[o]=!0):(bdplugins[o].plugin.stop(),pluginCookie[o]=!1),this.savePluginData()},PluginModule.prototype.showSettings=function(e){if(null!=bdplugins[e]&&"function"==typeof bdplugins[e].plugin.getSettingsPanel){var t=bdplugins[e].plugin.getSettingsPanel();$(".modal-inner").off("click.bdpsm").on("click.bdpsm",function(e){$("#bd-psm-id").length?$(".bd-psm").remove():$(".bd-psm").attr("id","bd-psm-id")}),$(".modal").append('<div class="bd-psm"><div class="scroller-wrap" style="height:100%"><div id="bd-psm-s" class="scroller" style="padding:10px;"></div></div></div>'),$("#bd-psm-s").append(t)}},PluginModule.prototype.loadPluginData=function(){var e=$.cookie("bd-plugins");void 0!=e&&(pluginCookie=JSON.parse($.cookie("bd-plugins")))},PluginModule.prototype.savePluginData=function(){$.cookie("bd-plugins",JSON.stringify(pluginCookie),{expires:365,path:"/"})},PluginModule.prototype.newMessage=function(){$.each(bdplugins,function(){pluginCookie[this.plugin.getName()]&&"function"==typeof this.plugin.onMessage&&this.plugin.onMessage()})},PluginModule.prototype.channelSwitch=function(){$.each(bdplugins,function(){pluginCookie[this.plugin.getName()]&&"function"==typeof this.plugin.onSwitch&&this.plugin.onSwitch()})};var themeCookie={};ThemeModule.prototype.loadThemes=function(){this.loadThemeData(),$.each(bdthemes,function(){var e=this.name,t=!1;themeCookie.hasOwnProperty(e)?themeCookie[e]&&(t=!0):themeCookie[e]=!1,t&&$("head").append('<style id="'+e+'">'+unescape(bdthemes[e].css)+"</style>")})},ThemeModule.prototype.handleTheme=function(e){var t=$(e).children().find('input[type="checkbox"]'),i=!t.is(":checked"),o=t.attr("id").substring(2);t.prop("checked",i),i?($("head").append('<style id="'+o+'">'+unescape(bdthemes[o].css)+"</style>"),themeCookie[o]=!0):($("#"+o).remove(),themeCookie[o]=!1),this.saveThemeData()},ThemeModule.prototype.loadThemeData=function(){var e=$.cookie("bd-themes");void 0!=e&&(themeCookie=JSON.parse($.cookie("bd-themes")))},ThemeModule.prototype.saveThemeData=function(){$.cookie("bd-themes",JSON.stringify(themeCookie),{expires:365,path:"/"})};var bdSocket,bdws;BdWSocket.prototype.start=function(){var e=this;$.ajax({method:"GET",url:"https://discordapp.com/api/gateway",headers:{authorization:localStorage.token.match(/\"(.+)\"/)[1]},success:function(t){e.open(t.url)}})},BdWSocket.prototype.open=function(e){},BdWSocket.prototype.onOpen=function(){utils.log("Socket Open");var e={op:2,d:{token:JSON.parse(localStorage.getItem("token")),properties:JSON.parse(localStorage.getItem("superProperties")),v:3}};bdws.send(e)},BdWSocket.prototype.onMessage=function(e){var t,i,o;try{t=JSON.parse(e.data),i=t.d,o=t.t}catch(n){return void utils.err(n)}switch(o){case"READY":break;case"PRESENCE_UPDATE":break;case"TYPING_START":break;case"MESSAGE_CREATE":break;case"MESSAGE_UPDATE":}},BdWSocket.prototype.onError=function(e){utils.log("onError: ")},BdWSocket.prototype.onClose=function(e){utils.log("Socket Closed - "+e.code+" : "+e.reason)},BdWSocket.prototype.send=function(e){utils.log("Sending: "+JSON.stringify(e)),bdSocket.send(JSON.stringify(e))},BdApi.joinServer=function(e){opublicServers.joinServer(e)},BdApi.injectCSS=function(e,t){$("head").append('<style id="'+e+'"></style>'),$("#"+e).html(t)},BdApi.clearCSS=function(e){$("#"+e).remove()},BdApi.getPlugin=function(e){return bdplugins.hasOwnProperty(e)?bdplugins[e].plugin:null},BdApi.getIpc=function(){return betterDiscordIPC},BdApi.getCore=function(){return mainCore},BdApi.getUserIdByName=function(e){for(var t=$(".member-username"),i=0;i<t.length;i++){var o=$(t[i]);if(o.text()==e){var n=o.closest(".member").find(".avatar-small").css("background-image");return n.match(/\d+/)}}return null};var gg;BdApi.getUserNameById=function(e){for(var t=$(".avatar-small"),i=0;i<t.length;i++){var o=$(t[i]),n=o.css("background-image");if(e==n.match(/\d+/))return o.parent().find(".member-username").text()}return null};